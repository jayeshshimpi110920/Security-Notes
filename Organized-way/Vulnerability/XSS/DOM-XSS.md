
### What is DOM XSS?

**DOM-based XSS (Document Object Model Cross-Site Scripting)** is a type of cross-site scripting where the attack is executed by modifying the DOM of the web page directly in the browser. Unlike traditional XSS (stored or reflected), the malicious input never reaches the server but is processed entirely in the client-side JavaScript code. DOM XSS occurs when JavaScript on the web page reads or writes user input unsafely into the DOM.

> * DOM(Document object model) is programming interface for web documents. Its represent the structure of HTML AND XML document as a tree object
> * DOM allows program to read and manipulate the structure and content of web page dynamically using language like javascript.

### How to Find DOM XSS

1. **Review JavaScript code**: Look for instances where user input is inserted into the DOM or used in unsafe ways, such as:
   - `document.write()`
   - `document.location`
   - `element.innerHTML`
   - `element.outerHTML`
   - `eval()`
   - `setTimeout()`
   - `setInterval()`
   - `window.location`
   - `location.hash`
   - `location.search`

2. **Fuzzing User Input**: Identify input fields, URL parameters, or any interaction that modifies the DOM and test them for unsafe rendering.

3. **Client-Side Tools**:
   - **Browser DevTools**: Inspect JavaScript code for DOM manipulations and monitor how data flows from user input into the DOM.
   - **Burp Suite with DOM Invader**: The **DOM Invader** extension can be used to detect DOM-based XSS vulnerabilities by interacting with and analyzing JavaScript code.
   - **OWASP ZAP**: It has DOM XSS scanners that can help find vulnerabilities by injecting payloads into client-side code and observing the output.
   - **Chrome DevTools' JavaScript Breakpoints**: Set breakpoints on DOM modifications to see if the user input is reflected unsafely.

4. **Automated Scanning**: Use tools like:
   - **Burp Suite Pro (Active Scanning)**: It has checks for DOM-based XSS vulnerabilities.
   - **Acunetix**: A commercial web vulnerability scanner that can detect DOM XSS.
   - **SonarQube**: Can help detect vulnerabilities in JavaScript code through static analysis.

### Example Payloads for DOM XSS Testing

Here are a few example payloads to try:

1. **Simple Alert Injection**:
   ```javascript
   <img src="x" onerror="alert(1)">```

2. Malicious Script Injection:

```javascript
<script>alert(document.cookie)</script>
```


3. URL-based Payload (if input is reflected in the URL):

```javascript
http://vulnerable-site.com/#<img src="x" onerror="alert(1)">
```


4. JavaScript Protocol (if input is used in location.href or eval()):

```javascript:alert(1)```


5. Element Attribute Manipulation (for innerHTML or outerHTML):

```<svg onload=alert(1)>```


6. Location Hash Example:

```#"><svg onload=alert(1)>```


When testing for DOM XSS, the key is to identify where the input is being used in the DOM and how JavaScript processes it. Different payloads might trigger alerts or script execution depending on where and how the input is reflected.


