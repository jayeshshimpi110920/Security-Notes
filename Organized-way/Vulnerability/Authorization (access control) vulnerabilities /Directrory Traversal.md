## Directory Traversal
Manipulating file paths to access files outside the permitted directory, often due to inadequate path sanitization.

**Example**: Using `../../` sequences to navigate to restricted directories or files, bypassing intended access controls.

---

A Directory Traversal attack (also known as Path Traversal) is a web security vulnerability that allows an attacker to access files and directories on a server outside the intended web root directory. By manipulating file paths, attackers can potentially gain unauthorized access to sensitive files, such as configuration files, application code, or other confidential information.

### What is Directory Traversal?
Directory traversal exploits occur when an application does not validate or sanitize user input that specifies file paths. Attackers can use relative file paths to "traverse" directories, typically using sequences like `../`, to access files and directories that are outside of the authorized directory structure.

#### Example
If an application allows a URL like `http://example.com/view?file=report.txt`, an attacker might modify it to:
- `http://example.com/view?file=../../../../etc/passwd` (on Linux)
- `http://example.com/view?file=..\..\..\..\windows\system32\config\sam` (on Windows)

This could give them access to critical system files.

### Impact of Directory Traversal
The impact of a successful directory traversal attack can be severe:
- **Data Leakage**: Attackers can view sensitive data, configuration files, or logs that might contain passwords, API keys, or system information.
- **System Compromise**: Attackers might access files that enable further exploitation, including credentials or source code with vulnerabilities.
- **Service Disruption**: In some cases, attackers might delete or modify files, leading to application or service instability.

### How to Prevent Directory Traversal
1. **Input Validation**: Only allow specific characters or restrict file paths to approved patterns.
2. **Use Parameterized Paths**: Instead of user-provided input, map inputs to predefined files, avoiding direct access to file system paths.
3. **Restrict File Permissions**: Ensure that the application user only has permissions for necessary files and directories.
4. **Normalize Paths**: Use built-in path normalization functions to convert file paths to a canonical form before processing.
5. **Server-Side Security Measures**: Configure the server to deny access to sensitive directories and disable directory listing.
6. **Use a Whitelist Approach**: Only allow access to files that match a specific, safe whitelist of allowed files or paths.

### How to Find Directory Traversal Attacks
You can find directory traversal vulnerabilities both manually and with tools. Hereâ€™s how to do it:

#### 1. **Manual Testing**
   - **Check Input Fields for Path Parameters**: Look for parameters like `file`, `path`, or `directory` that could control file access.
   - **Craft Payloads**: Inject traversal sequences like `../../../../` into the parameters and monitor the server's responses. Variations may include:
     - `/../` (for UNIX/Linux systems)
     - `\..\` (for Windows systems)
     - URL-encoded payloads (e.g., `%2e%2e%2f` or `%2e%2e%5c`)
   - **Test with Common Paths**: Try accessing known file locations, such as:
     - `/etc/passwd`, `/etc/hosts` (Linux)
     - `C:\Windows\System32\config\SAM` (Windows)
   - **Observe Error Messages**: Server error messages can sometimes reveal traversal success or hint at directory structure.

#### 2. **Automated Tools**
   - **Burp Suite**: Burp Suite's Intruder tool allows you to automate payload injection into parameters. It also has plugins like **Burp BApp - Passive Scanner** to detect directory traversal.
   - **OWASP ZAP**: ZAP can perform fuzzing on inputs with directory traversal payloads and scan for vulnerabilities automatically.
   - **Nikto**: This tool can scan for common vulnerabilities, including directory traversal on web servers.
   - **Wfuzz**: Wfuzz can be used to brute-force directory traversal payloads in parameters.

#### 3. **Other Techniques**
   - **Log File Inspection**: Check logs for signs of directory traversal patterns, such as repeated sequences of `../`.
   - **Source Code Review**: If you have access to the source code, look for any file path inputs or handling functions that lack sanitization or validation.

#### Example Payloads to Use in Testing
1. Standard traversal: `../../../../etc/passwd`
2. URL-encoded traversal: `%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2fetc/passwd`
3. Double URL-encoded: `%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/passwd`

### Summary of Detection Methods
- **Manual Payload Testing**: Using traversal sequences in vulnerable parameters.
- **Automated Tool Scanning**: Using security tools like Burp Suite, ZAP, or Nikto.
- **Log Monitoring**: Reviewing server logs for unusual file access patterns.
- **Source Code Analysis**: Analyzing code for improper handling of file path inputs.

Detecting and preventing directory traversal is key to maintaining file system security, especially for applications that handle sensitive or confidential data.
