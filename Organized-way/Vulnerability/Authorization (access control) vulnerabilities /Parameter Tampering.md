## Parameter Tampering
Modifying parameters like `user_role` or `account_type` in requests to elevate privileges or access restricted actions.

**Example**: Changing `user_role=guest` to `user_role=admin` in a request to gain administrative access.

---
Parameter tampering is a type of web application attack where an attacker manipulates parameters exchanged between the client and the server to bypass security mechanisms, gain unauthorized access, or exploit application functionality. This can lead to various impacts, including unauthorized access, privilege escalation, and data manipulation.

### What is Parameter Tampering?
Parameter tampering involves altering parameters in web requests, such as form fields, query parameters, cookies, or headers, to interfere with the normal operation of the application. Attackers often target parameters that control sensitive actions, such as user roles, pricing, permissions, or account access.

#### Common Examples of Parameter Tampering
1. **Price Manipulation**: Changing the price parameter in an e-commerce website to buy items at a lower price (e.g., modifying `price=100` to `price=1`).
2. **Privilege Escalation**: Altering user role or access parameters (e.g., changing `role=user` to `role=admin`) to gain unauthorized privileges.
3. **User ID Manipulation**: Modifying the `user_id` in requests to access or modify another user’s information (e.g., changing `/profile?user_id=123` to `/profile?user_id=456`).

### Impact of Parameter Tampering
- **Unauthorized Access**: Accessing data or resources that should be restricted.
- **Privilege Escalation**: Gaining higher privileges by manipulating role or permission parameters.
- **Financial Impact**: Altering prices, discounts, or quantities to exploit financial transactions.
- **Data Manipulation**: Modifying data in the application, which can lead to data corruption or misuse.
- **Security Violations**: Potential breaches of confidentiality, integrity, and availability, especially in sensitive applications like banking or healthcare.

### How to Prevent Parameter Tampering
1. **Server-Side Validation and Controls**:
   - Perform all critical checks on the server side to ensure no sensitive actions are directly controlled by client-provided parameters.
   - Avoid trusting parameters sent from the client, especially for actions that impact security or business logic.

2. **Implement Strong Access Control Mechanisms**:
   - Ensure that each user has the proper access rights for the requested resource, regardless of parameters sent.
   - Use session-based and role-based access controls to restrict sensitive actions.

3. **Use Parameter Encryption or Hashing**:
   - For sensitive parameters (e.g., user roles, prices), use server-generated encrypted or hashed values that the client cannot tamper with.
   - For example, instead of sending `price=100`, send an encrypted value that is validated on the server.

4. **Avoid Sensitive Information in URLs**:
   - Use POST requests for sensitive data rather than GET parameters to minimize visibility and tampering potential.
   - Store critical session data on the server instead of relying on client-side parameters.

5. **Use Strong Session Management**:
   - Maintain a strict session validation mechanism, linking session tokens with user privileges and actions allowed.

6. **Employ Web Application Firewalls (WAFs)**:
   - WAFs can detect and block suspicious or unusual parameter changes that deviate from typical patterns.

### How to Find Parameter Tampering Vulnerabilities

#### 1. **Manual Testing**
   - **Alter Request Parameters**: Modify query parameters, form fields, and URL paths to observe any unintended changes in behavior. For example, alter `price`, `user_id`, or `role` values.
   - **Inspect Cookie and Session Data**: Check cookies or session parameters that might store information about roles or permissions and try changing these values.
   - **Identify Client-Side Hidden Fields**: Hidden form fields may store sensitive values. Alter hidden input values in forms to see if changes are reflected in server responses.
   - **Check for IDOR (Insecure Direct Object References)**: Modify resource identifiers (e.g., user IDs) to see if you can access or manipulate data for other users.

#### 2. **Automated Tools**
   - **Burp Suite**: Burp’s Repeater and Intruder tools allow for easy modification of parameters in requests. Intruder can be used to brute-force and enumerate parameter values, while Repeater is useful for manually changing parameters and observing responses.
   - **OWASP ZAP**: ZAP’s “Forced Browse” and parameter tampering features can help identify vulnerabilities by brute-forcing common parameters and checking for unexpected behaviors.
   - **Postman**: While primarily a testing tool, Postman is useful for manually modifying parameters in requests to test for tampering vulnerabilities.
   - **Fuzzing Tools (e.g., ffuf, Wfuzz)**: These can automate testing of parameters by fuzzing values and analyzing responses for security issues.

### Common Techniques for Testing Parameter Tampering
1. **Role Manipulation**:
   - Change values related to user roles or privileges (e.g., `role=user` to `role=admin`).
   - Check if changing roles enables unauthorized access to admin functionalities.

2. **Price and Quantity Manipulation**:
   - Modify price or quantity values in purchase requests to check if the application processes the altered values without server-side verification.

3. **ID Manipulation (IDOR Testing)**:
   - Test by changing user IDs or other identifiers to access data belonging to different users.
   - Verify if this grants unauthorized access to profiles, orders, or private data.

4. **Parameter Boundary Testing**:
   - For numeric parameters, try large or negative values (e.g., setting `quantity=-1` to test for unintended discounts).
   - Test with special characters or unexpected data types to see if the application handles inputs securely.

### Summary
Parameter tampering is a critical security issue that can lead to unauthorized access, privilege escalation, and data manipulation. By validating inputs on the server side, encrypting sensitive data, implementing proper access control, and conducting thorough security testing, organizations can prevent this vulnerability. Both manual testing and automated tools like Burp Suite and OWASP ZAP are effective for identifying and mitigating parameter tampering risks in web applications.
